var w=Object.defineProperty;var E=(i,e,t)=>e in i?w(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var a=(i,e,t)=>(E(i,typeof e!="symbol"?e+"":e,t),t);const v=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}};v();const f=/\([^\(\)]+\)/,x=/\-?\d+(,\d+)?(x|\/)\-?\d+(,\d+)?/,O=/\-?\d+(,\d+)?(\+|\-)\-?\d+(,\d+)?/,m=/√\d+/,d=425,k=45,g=36,l=(i,e)=>i[0]==="-"&&e==="-"?[`-${i.split(e)[1]}`,i.split(e)[2]].map(r=>Number(r.replace(",","."))):i.split(e).map(t=>Number(t.replace(",","."))),b=i=>{const e=window.screen.width<d?window.screen.width-60:d-80;return Math.min(Math.ceil(e/i*1.6),window.screen.width<d?g:k)};class S{constructor(e,t){a(this,"display1");a(this,"display2");a(this,"currentOperand");a(this,"currentOperation");a(this,"calculate",(e,t)=>{let r;switch(t){case"*":r=l(e,t)[0]*l(e,t)[1];break;case"x":r=l(e,t)[0]*l(e,t)[1];break;case"/":r=l(e,t)[0]/l(e,t)[1];break;case"+":r=l(e,t)[0]+l(e,t)[1];break;case"-":r=l(e,t)[0]-l(e,t)[1];break}return String(r==null?void 0:r.toFixed(10)).replace(".",",").replace(/\,?0*$/,"")});a(this,"doSecondActions",e=>{let t=e,r=O.exec(t);for(;r;){const n=r[0],s=r[2],c=this.calculate(n,s);t=t.replace(n,String(c)),r=O.exec(t)}return t});a(this,"openBrackets",e=>{let t=e,r=0,n=f.exec(t);for(;n&&r<3;){const s=n[0].slice(1,-1),c=this.doSecondActions(this.doFirstActions(s));t=t.replace(n[0],String(c)),n=f.exec(t),r++}return t});a(this,"defineRoots",e=>{let t=e,r=0,n=m.exec(t);for(;n&&r<3;){const s=n[0].replace("\u221A",""),c=Math.sqrt(Number(s)).toFixed(10);t=t.replace(n[0],String(c)),n=m.exec(t),r++}return t});a(this,"calculateExp",()=>{if(this.currentOperation==="=")return;const e=this.display1.textContent+this.currentOperand,t=this.openBrackets(e),r=this.defineRoots(t),n=this.doFirstActions(r),s=this.doSecondActions(n);if(this.display1.innerText+=this.currentOperand+"=",this.currentOperation="=",isFinite(Number(s.replace(",",".")))){this.display2.style.fontSize=`${b(s.length)}px`,this.currentOperand=s,this.display2.innerText=s;return}this.display2.innerText="ERROR",this.currentOperand=""});this.display1=e,this.display2=t,this.currentOperand="",this.currentOperation=""}clear(){this.display1.innerText="",this.display2.innerText="0",this.currentOperand="",this.display2.style.fontSize=`${window.screen.width<d?g:k}px`}appendNumber(e){e===","&&this.currentOperand.includes(",")||(/=|√/.test(this.currentOperation)&&this.clear(),this.currentOperand+=e,this.display2.style.fontSize=`${b(this.currentOperand.length)}px`,this.display2.innerText=this.currentOperand,this.currentOperation="")}openBracket(){if(this.currentOperand){this.display1.innerText+=this.currentOperand+"x(",this.currentOperand="";return}this.display1.innerText+="("}closeBracket(){const e=this.display1.innerText.split("(").length,t=this.display1.innerText.split(")").length;this.currentOperation||e<=t||(this.display1.innerText+=this.currentOperand+")",this.currentOperand="")}chooseOperation(e){if(this.currentOperation==="="){this.currentOperation=e,e==="\u221A"?this.display1.innerText=e+this.currentOperand:this.display1.innerText=this.currentOperand+e,this.currentOperand="";return}if(e==="\u221A"){if(!this.currentOperand){const t=this.display1.innerText,r=t.lastIndexOf("(");this.display1.innerText=`${t.slice(0,r)}\u221A${t.slice(r)}`,this.currentOperand="";return}this.currentOperation=e,this.display1.innerText+=`\u221A(${this.currentOperand})`,this.currentOperand="";return}this.currentOperation===""||this.currentOperation==="\u221A"?(this.currentOperation=e,this.display1.innerText+=this.currentOperand+e):(this.currentOperation=e,this.display1.innerText=this.display1.innerText.slice(0,-1)+this.currentOperand+e),this.currentOperand=""}doFirstActions(e){let t=e,r=x.exec(t);for(;r;){const n=r[0],s=r[2],c=this.calculate(n,s);t=t.replace(n,String(c)),r=x.exec(t)}return t}}const T=document.querySelector("#app"),A=(i,e,t)=>{const r=document.createElement(i);return e&&e.forEach(n=>r.classList.add(n)),t&&(r.textContent=t),r},L=[{value:"c",type:"clear"},{value:"\u221A",type:"operation"},{value:"%",type:"operation"},{value:"/",type:"operation"},{value:"7",type:"number"},{value:"8",type:"number"},{value:"9",type:"number"},{value:"x",type:"operation"},{value:"4",type:"number"},{value:"5",type:"number"},{value:"6",type:"number"},{value:"-",type:"operation"},{value:"1",type:"number"},{value:"2",type:"number"},{value:"3",type:"number"},{value:"+",type:"operation"},{value:"00",type:"number"},{value:"0",type:"number"},{value:",",type:"number"},{value:"=",type:"equal"}],p=document.createElement("div");p.classList.add("container");T.appendChild(p);const h=document.createElement("div");h.classList.add("display1");p.appendChild(h);const u=document.createElement("div");u.classList.add("display2");u.innerText="0";p.appendChild(u);const o=new S(h,u),y=document.createElement("div");y.classList.add("controls");p.appendChild(y);L.forEach(i=>{const e=A("button",["button"],String(i.value));switch(i.type){case"clear":e.addEventListener("click",()=>o.clear());break;case"operation":e.addEventListener("click",()=>o.chooseOperation(e.innerText));break;case"number":e.addEventListener("click",t=>{t.pointerId!==-1&&o.appendNumber(e.innerText)});break;case"equal":e.addEventListener("click",()=>o.calculateExp());break}y.appendChild(e)});window.addEventListener("keyup",i=>{if(/\d|\.|\,/.test(i.key)){const e=i.key==="."?",":i.key;o.appendNumber(e)}if(/\+|\-|\/|\*|x/.test(i.key)){const e=i.key==="*"?"x":i.key;o.chooseOperation(e)}i.key==="("&&o.openBracket(),i.key===")"&&o.closeBracket(),(i.key==="="||i.key==="Enter")&&(i.preventDefault(),o.calculateExp())});
